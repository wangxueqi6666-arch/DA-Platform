# 网站内容开发任务清单（DA Platform）

本文件为网站（前端 + 后端）的内容开发任务清单，面向当前代码结构与已配置的工程环境，包含明确的范围、任务拆解、验收标准与里程碑，便于团队执行与追踪。可直接用于需求评审与排期。

## 1. 项目概览
- 当前结构：
  - 前端：`frontend/`（Vite + React），入口 `index.html`，代码位于 `src/`（`App.jsx`、`pages/`、`api/` 等）。
  - 后端：`backend/`（Node.js + Express），主文件 `src/server.js`，已提供 `/`、`/health`、`/api/users`、`/api/frames` 示例。
  - CI/CD：`.github/workflows/backend.yml` 已实现后端镜像构建与推送 GHCR；前端尚未配置 CI。
  - Docker：后端已具备 `Dockerfile` 与 `.dockerignore`；前端暂无容器化方案。

## 2. 目标与范围
- 目标：完成网站的核心页面与内容，打通与后端的基础数据交互，具备可预览与基础测试能力，逐步完善标注业务相关功能。
- 范围：
  - 前端页面与组件内容实现（含 3D 标注页、导航、列表、详情、设置、错误页）。
  - 前端 API 封装与环境变量读取，打通后端已提供的健康检查与示例数据接口。
  - 后端补充必要的内容接口（在示例基础上扩展），并为后续标注数据上传与存储预留结构。
  - DevOps：前端 CI 工作流与预览构建；环境变量与配置管理。

## 3. 前置条件
- Node.js 与 npm 可用；本地已能运行 `frontend` 与 `backend` 开发服务器。
- 后端运行于 `http://localhost:8080`；前端运行于 `http://localhost:5173`。
- 建议前端设置 `VITE_API_BASE=http://localhost:8080`（`frontend/.env`）。

## 4. 任务总览
- 前端内容与交互（页面、组件、路由、样式、API）
- 后端内容接口扩展（数据模型、路由、上传、鉴权）
- DevOps 与部署（前端 CI、容器化、环境变量、预览）
- 质量保障（测试、可访问性、性能）

---

## 5. 前端任务

### 5.1 全局框架与基础
- [ ] 在 `frontend/.env` 支持 `VITE_API_BASE` 并在 `src/api/` 统一读取使用。
- [ ] 在 `src/api/` 添加基础 `httpClient`（基于 `fetch` 或 `axios`），支持超时、错误处理与 JSON 解析。
- [ ] 在 `src/main.jsx` 或 `App.jsx` 建立全局布局（导航栏、页脚、主内容区）。
- [ ] 在 `vite.config.js` 增加开发代理（可选）将 `/api` 代理到 `http://localhost:8080`，减少跨域配置成本。

验收标准：
- 在任意页面可调用 `GET /health`，显示后端在线状态；失败时有用户友好提示。
- 网络错误与超时有统一错误处理，不影响页面基本导航。

### 5.2 导航与路由
- [ ] 使用 `react-router` 配置基础路由：`/`（首页）、`/annotate/3d`（3D 标注页）、`/projects`、`/datasets`、`/settings`、`/error`。
- [ ] 导航栏实现站点导航、当前页面高亮、站点 Logo/名称。
- [ ] 404 与错误页：兜底与引导返回首页。

验收标准：
- 所有已定义路由均可访问且路由跳转无控制台报错。
- 手工访问不存在地址时呈现 404 页面，包含返回按钮。

### 5.3 首页（`/`）
- [ ] 展示项目简介、快速入口（前往 3D 标注、项目列表、数据集等）。
- [ ] 显示后端健康状态（`/health`）与示例数据预览（`/api/users`、`/api/frames`）。

验收标准：
- 首页无阻塞渲染；后端离线时有降级显示与重试入口。

### 5.4 3D 标注页（`/annotate/3d`）
- [ ] 页面骨架：工具栏（选择、框选、撤销/重做、保存）、侧边面板（图层/对象列表）、主视图（画布/三维视图）。
- [ ] 接入示例帧数据（`/api/frames`），支持加载与基本列表浏览。
- [ ] 标注数据的内存模型与基本交互（占位实现）：新增对象、编辑属性、删除对象（暂不需持久化）。
- [ ] 保存动作（占位）与 UI 反馈；为后续后端持久化接口预留调用点。

验收标准：
- 工具栏与侧边面板可操作；主视图加载示例帧列表并可切换查看。
- 标注对象的新增/编辑/删除在前端状态中可见，且操作有提示。

### 5.5 项目列表页（`/projects`）
- [ ] 列表布局与占位数据；支持搜索/筛选（本地）。
- [ ] 预留与后端项目 API 对接的接口调用位置（待后端实现）。

验收标准：
- 列表渲染稳定，交互无错误；有空态与加载态。

### 5.6 数据集页（`/datasets`）
- [ ] 数据集列表与基本信息展示；上传入口（占位）。
- [ ] 上传控件 UI（文件选择、拖拽区）；不需真实上传，留接口位。

验收标准：
- 上传控件与页面元素可操作，有校验与提示；无实际上传亦无报错。

### 5.7 设置页（`/settings`）
- [ ] 显示与编辑基础设置（例如 API 基址、主题、语言）。
- [ ] 持久化到 `localStorage`（占位），并提供重置按钮。

验收标准：
- 设置更改可即时反映；刷新后仍能保留（本地持久化）。

### 5.8 组件与样式
- [ ] 统一样式规范（色板、间距、字号、组件大小）；在 `App.css` 或 CSS-in-JS 中维护。
- [ ] 基础组件库：按钮、输入框、选择器、对话框、通知条、加载骨架。
- [ ] 响应式布局：针对常见分辨率（移动端/桌面端）。

验收标准：
- 样式在主要页面一致；常见屏幕尺寸下布局不破。

### 5.9 可访问性与国际化（可选）
- [ ] 常见可访问性实践（语义化标签、可聚焦、对比度、键盘操作）。
- [ ] i18n 架构与基础文案抽离（中文为主，英文为辅）。

验收标准：
- 重要交互可键盘操作；文本与组件有可读标签。

### 5.10 前端测试
- [ ] 组件与页面的基础单元测试（渲染、交互）。
- [ ] API 封装的单元测试（成功/失败分支）。

验收标准：
- 测试用例可在 CI 中稳定运行并通过。

---

## 6. 后端任务

### 6.1 API 设计与路由
- [ ] 扩展示例接口：`/api/projects`、`/api/datasets`（列表 + 详情）。
- [ ] 标注相关占位接口：`/api/annotations`（创建/更新/删除/查询，暂用内存或简单文件存储）。
- [ ] 健康检查已存在：`/health`；完善返回信息（版本、时间、依赖状态）。

验收标准：
- 所有新增接口返回结构清晰，含错误码与错误消息。

### 6.2 数据模型与存储（阶段性）
- [ ] 内存模型或 JSON 文件存储（原型期）；为后续数据库（PostgreSQL/MongoDB）预留接口。
- [ ] 文件上传临时存储与校验（大小、类型）。

验收标准：
- 接口具备基本 CRUD；错误与边界情况可处理。

### 6.3 鉴权与安全（后续）
- [ ] 简单令牌鉴权占位（中间件），控制管理页访问。
- [ ] CORS 策略与请求限速（开发阶段可宽松）。

验收标准：
- 鉴权生效、错误路径可预期；CORS 满足前端访问需要。

### 6.4 后端测试与文档
- [ ] 路由与服务的基础单元测试。
- [ ] 使用 `README.md` 或 `/docs` 追加接口文档（请求/响应示例）。

验收标准：
- 关键接口具备至少一个测试用例；文档可读且与实现一致。

---

## 7. DevOps 与部署
- [ ] 新增前端 CI 工作流：安装依赖、构建、（可选）测试、发布构建产物为 Artifact。
- [ ] 前端容器化（可选）：添加 `frontend/Dockerfile`，用于静态资源构建与 Nginx 托管。
- [ ] 配置环境变量注入：前端 `VITE_` 前缀；后端 `.env`（已有 `.env.example`）。
- [ ] 文档化部署步骤：本地、容器、云平台（Vercel/Netlify/GH Pages、Render/Fly/自托管）。

验收标准：
- 推送到 GitHub 后，前端 CI 自动运行并可下载构建产物；后端流程保持稳定。

---

## 8. 质量保障
- [ ] 性能初检：首屏加载、资源体积（Vite 构建分析）。
- [ ] 可访问性初检：语义、对比度、键盘导航。
- [ ] 代码风格：ESLint（已有配置）、Prettier（可选）。

验收标准：
- 关键页面无阻塞错误；构建体积合理；基本可访问性达标。

---

## 9. 里程碑与交付
**里程碑 A：基础连通（1 周）**
- 前端首页与 3D 标注页骨架完成；健康检查显示；示例数据加载。
- 后端接口扩展项目/数据集占位；注释与文档补充。
- 前端 CI 首次落地（安装与构建）。

**里程碑 B：核心交互（1–2 周）**
- 标注对象的增删改在前端可视；保存占位与反馈完善。
- 项目/数据集列表页具备基本筛选与空态；上传控件 UI 完成。
- 后端文件上传占位与注释说明；测试用例覆盖关键流程。

**里程碑 C：优化与扩展（1–2 周）**
- 可访问性与性能优化；路由守卫与设置页完善。
- 前端容器化与部署样例；接口文档完善。

---

## 10. 下载与使用说明
- 本清单文件路径：`website-content-dev-tasks.md`
- 可在 IDE 中直接下载此文件或复制到外部文档平台（如 Confluence、Notion）。
- 执行顺序建议：先完成“里程碑 A”中的连通与骨架；随后推进交互与扩展。

---

## 11. 附录：参考接口示例
- 健康检查：`GET http://localhost:8080/health`
- 用户列表：`GET http://localhost:8080/api/users`
- 帧列表：`GET http://localhost:8080/api/frames`
- 前端开发服务器：`http://localhost:5173/`

> 说明：示例接口来自当前后端 `src/server.js`，可作为前端联通与渲染的初始数据源。
## 12. 3D 标注开发任务（Annotator）

本章节聚焦 3D 标注页（`/annotate/3d`）的功能路线与任务拆解，便于对齐近期迭代目标与交付标准。

### 12.1 已完成（当前实现）
- [x] 主视图：支持 XYZ 方向拖拽框体，变换控件与相机互斥。
- [x] 三视图：边缘调整后保持缩放不变，交互连续性更佳。
- [x] 三视图：左键平移框体，并与主视图保持中心同步。
- [x] 属性弹窗：主视图拉框完成后弹出属性选择，支持默认类型（基于尺寸猜测）、保存/取消、点击页面空白关闭。
- [x] 右侧结果栏：保存后新增标注记录，支持点击选中同步到主视图与三视图。
- [x] 选中高亮：再次选择对象或在主视图点击标注框，载入为当前编辑对象并高亮显示。
- [x] 快捷键：`Z` 唤起当前聚焦对象的属性面板以修改后保存。
- [x] 主视图：默认显示所有已标注框，盒体内显示 `ID｜类型` 标签，便于排查遗漏与重复。

### 12.2 待开发（优先级建议）
1) 显示与交互增强（高优先）
- [ ] 标签文本自适应缩放与遮挡优化（近大远小、避免与边框重叠）。
- [ ] 类型配色方案与过滤开关（按类型显隐、颜色统一配置）。
- [ ] 框体选中样式统一（高亮颜色/透明度/边框样式枚举）。
- [ ] 删除标注与撤销/重做（Delete、Ctrl/Cmd+Z、Ctrl/Cmd+Y）。
- [ ] 框体旋转编辑（Yaw/Pitch/Roll），与三视图联动。
- [ ] 多选与批量操作（移动、删除、类型批量修改）。

2) 属性与弹窗（中高优先）
- [ ] 弹窗位置靠近框体或跟随鼠标、支持拖拽与键盘导航。
- [ ] 默认类型规则配置化（数据集/项目级规则），可覆盖与扩展。
- [ ] 扩展属性字段（朝向/速度/可信度/备注等），统一校验与展示。

3) 同步与持久化（高优先）
- [ ] 前后端同步：保存/加载/提交审核接口定义与前端接入。
- [ ] 本地暂存与断点续标（localStorage/IndexedDB），避免数据丢失。
- [ ] 导出/导入：支持 JSON 以及常见格式（KITTI/Waymo）兼容。
- [ ] 版本与审计记录（修改历史、提交记录、责任人）。

4) 性能与体验（中优先）
- [ ] 点云渲染优化（LOD、采样、点大小自适应、批渲染）。
- [ ] 标注渲染分层与批处理（提高多对象场景的帧率）。
- [ ] 相机书签与视角重置（常用视角快速切换）。

5) 快捷键与可用性（中优先）
- [ ] 完整快捷键映射（删除、复制、切换类型、显隐开关等）。
- [ ] 快捷键提示面板与禁用模式（避免与浏览器/系统快捷键冲突）。
- [ ] 新手引导与帮助卡片（核心操作说明与视频/动图）。

6) 测试与质量（持续）
- [ ] 关键交互单元测试（框体创建/拖拽/选中/保存）。
- [ ] 端到端用例（加载→标注→保存→提交→回显）。
- [ ] 性能基准与回归（大点云与多对象场景稳定性）。

### 12.3 里程碑建议
- 里程碑 M1（核心可用，1 周）：类型配色与过滤、删除与撤销/重做、保存/加载接口打通。
- 里程碑 M2（体验提升，1–2 周）：旋转支持、标签自适应、相机书签、性能优化初版。
- 里程碑 M3（完整工作流，1–2 周）：导出/导入、版本记录、端到端测试与文档完善。

### 12.4 提交规范（建议）
- `feat(annotator): 描述` — 新功能；`fix(annotator): 描述` — 修复；`perf(annotator): 描述` — 性能优化；`test(annotator): 描述` — 测试；`docs(annotator): 描述` — 文档。
- PR 需包含：变更摘要、测试（若有）、截图或动图（UI 相关）、回滚方案（必要时）。